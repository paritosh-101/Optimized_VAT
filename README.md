VAT algorithms implemented for my convenience.